# Transcript
# Start-Transcript -Path .\Transcript.log -Append
# FilePath
# $Filepath = 'K:\CPM'
# Get hostname and Lower char
# $hostname = $env:COMPUTERNAME.ToLower()
# Defein Data source
# 26 Zeta in total
$1 = 'w656411,10561411,KomaxZeta;
w656414,10561414,KomaxZeta;
w656415,10561415,KomaxZeta;
w656436,10561436,KomaxZeta;
w656437,10561437,KomaxZeta;
w656478,10561478,KomaxZeta;
w656579,10561579,KomaxZeta;
w656580,10561580,KomaxZeta;
w656581,10561581,KomaxZeta;
w656582,10561582,KomaxZeta;
w656583,10561583,KomaxZeta;
w656584,10561584,KomaxZeta;
w656585,10561585,KomaxZeta;
w656600,10561600,KomaxZeta;
w656601,10561601,KomaxZeta;
w740567,10564567,KomaxZeta;
w740569,10564569,KomaxZeta;
w740570,10564570,KomaxZeta;
w740571,10564571,KomaxZeta;
w740573,10564573,KomaxZeta;
w740578,10564578,KomaxZeta;
w740607,10564607,KomaxZeta;
w740608,10564608,KomaxZeta;
w740609,10564609,KomaxZeta;
w740660,10564660,KomaxZeta;
w740661,10564661,KomaxZeta
'
<#

#>

<#
c028552,10702007,;
c037250,10751011,;
c040929,10751001,;
c040922,10751004,;
c040926,10734012,;
c040936,10702004,;
c040928,10702003,;
c023493,10734014,;
c045371,10409709,;
komax010,10458010,;
komax509,10452509,;
c037082,10460384,;
koamx104,10409104,;
komax028,10460028,;
w355867,10598867,Komax;
w355868,10598868,Komax;
w355876,10598876,Komax;
w355877,10598877,Komax;
w355886,10598886,Komax;
w355887,10598887,Komax;
w355888,10598888,Komax;
w355915,10598915,Komax;
w355916,10598916,Komax;
w355917,10598917,Komax;
w355918,10598918,Komax;
w355919,10598919,Komax;
w355920,10598920,Komax;
w355921,10598921,Komax;
w355922,10598922,Komax;
w355923,10598923,Komax;
w355924,10598924,Komax;
w355928,10598928,Komax;
w355929,10598929,Komax;
w355930,10598930,Komax;
w355931,10598931,Komax;
w355932,10598932,Komax;
w355933,10598933,Komax;
w355934,10598934,Komax;
w355935,10598935,Komax;
w355936,10598936,Komax;
w355937,10598937,Komax;
w355938,10598938,Komax;
w355939,10598939,Komax;
w355940,10598940,Komax;
w355945,10598945,Komax;
w355946,10598946,Komax;
w455900,10585900,Komax;
w455901,10585901,Komax;
w455902,10585902,Komax;
w455903,10585903,Komax;
w455904,10585904,Komax;
w455905,10585905,Komax;
w488449,10594449,Komax488;
w488453,10594453,Komax488;
w488456,10594456,Komax488;
w488464,10592464,Komax488;
w488470,10601470,Komax488;
w488632,10605632,Komax488;
w488639,10605639,Komax488;
w488683,10605683,Komax488;
w488684,10605684,Komax488;
w488686,10605686,Komax488;
w488687,10605687,Komax488;
w488692,10605692,Komax488;
w488693,10605693,Komax488;
w488694,10605694,Komax488;
w488706,10605706,Komax488;
w488707,10605707,Komax488;
w488832,10592832,Komax488;
w488833,10592833,Komax488;
w488835,10592835,Komax488;
w488836,10592836,Komax488;
w488837,10592837,Komax488;
w488962,10594962,Komax488;
w488963,10594963,Komax488;
w488964,10594964,Komax488;
w688760,10516760,Komax488;
w688761,10516761,Komax488;
w688762,10516762,Komax488;
w688765,10515765,Komax488;
w688768,10516768,Komax488;
w688769,10516769,Komax488;
w688785,10516785,Komax488;
w688786,10516786,Komax488;
w688792,10516792,Komax488;
w688793,10516793,Komax488;
w688794,10516794,Komax488;
w688795,10516795,Komax488;
w688796,10516796,Komax488;
w688802,10516802,Komax488;
w688803,10516803,Komax488;
w530088,10518088,Komax;
w530089,10518089,Komax;
w530106,10518106,Komax;
w530107,10518107,Komax;
w530145,10518145,Komax;
w530146,10518146,Komax;
w530147,10518147,Komax;
w530350,10518350,Komax;
w530351,10518351,Komax;
w530352,10518352,Komax;
w530353,10518353,Komax;
w530354,10518354,Komax;
w530780,10518780,Komax;
w530781,10518781,Komax;
w530782,10518782,Komax;
w530783,10518783,Komax;
w530784,10518784,Komax;
w530787,10518787,Komax;
w530788,10518788,Komax;
w530789,10518789,Komax;
w530790,10518790,Komax;
w530791,10518791,Komax;
w530797,10518797,Komax;
w530798,10518798,Komax;
w530799,10518799,Komax;
w530800,10518800,Komax;
w530801,10518801,Komax;
w550148,10519148,Komax;
#>

# Data transform
$2 = $1 -split ';'



# Match hostnamefore
foreach($3 in $2){
    $3 = $3 -split ','
    $4 = $3[0].trim()
    Test-Connection -ComputerName $4 -Count 1 -ErrorAction SilentlyContinue
    # Invoke-Command -ComputerName $4 -ScriptBlock{Get-Service -Name *CPM* -Verbose} -ErrorAction SilentlyContinue -Verbose
    # Write-Host $3[0],$3[1].length,$3[2].length；
    }


# Lastmodify on 14th July
# $etime =Get-Date
# $log = $hostname +" "+ $etime
# $log | Out-File .\job.log -Append


# Stop-Transcript

<#
Get-Date | Out-File -FilePath .\job.log -Append -NoNewline
Get-FileHash .\MESCPM.ps1 | select -ExpandProperty hash | Out-File -FilePath .\job.log -Append
#>